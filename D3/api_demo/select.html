<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>
		D3 Core-select
	</title>
	<!-- D3 -->
	<script type="text/javascript" src="../d3.min.js"></script>
	<!-- hightlight code -->
	<script type="text/javascript" src="../highlight/prism.js"></script>
	<link rel="stylesheet" type="text/css" href="../highlight/prism.css" />
	<!-- styles -->
	<link rel="stylesheet" type="text/css" href="./styles.css" />
</head>
<body>
<div style="margin: 0 auto; width: 1200px;">
	<caption>【Core 核心】</caption>
	<table>
		<tbody>
			<tr class="name">
				<th>选择器</th>
				<th>含义</th>
			</tr>
			<tr>
				<th><a href="#d3_select_selector">d3.select(selector)</a></th>
				<th>选择第一个与指定字符串selector相匹配的元素</th>
			</tr>
			<tr>
				<th><a href="#d3_select_node">d3.select(node)</a></th>
				<th>选择指定的节点</th>
			</tr>
			<tr>
				<th><a href="#d3_selectAll_selector">d3.selectAll(selector)</a></th>
				<th>选择所有与指定字符串slector相匹配的元素，选择的结果是一个数组，这些元素会按照文档的遍历顺序（从上到下）存入数组</th>
			</tr>
			<tr>
				<th><a href="#d3_selectAll_nodes">d3.selectAll(nodes)</a></th>
				<th>选择指定的节点数组</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_attr">selection.attr(name[, value])</a></th>
				<th>如果指定了value参数，则用来设置所有选中元素中指定属性的值，否则返回选择集中第一个非空元素中指定属性的值
				</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_classed">selection.classed(name[, value])</a></th>
				<th>如果没有指定value参数，则返回与name参数匹配的第一个非空元素是否绑定了指定的CSS类</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_style">selection.style(name[, value[, priority]])</a></th>
				<th>返回选择集中第一个非空元素中名为name的样式值，或设置选择集中所有元素中名为name的样式值为value参数指定的值</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_property">selection.property(name[, value])</a></th>
				<th>一些HTML元素具有特殊的内置属性，使用标准的属性或样式操作符是访问不到的</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_text">selection.text([value])</a></th>
				<th>返回第一个非空元素的文本内容，或设置选择集中所有元素的文本内容为指定的值</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_html">selection.html([value])</a></th>
				<th>html操作符基于innerHTML属性，设置内部HTML的内容为value参数指定的值并取代任何已有的子元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_append">selection.append(name)</a></th>
				<th>在当前选择集的最后追加指定名称的子元素，返回的新选择集包含这个新追加的子元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_insert">selection.insert(name[, before])</a></th>
				<th>如果指定了before参数，则在选择集中的before参数指定的元素前添加name参数指定的元素；如果没有指定before参数或没有子元素匹配before参数，则直接使用selection.append的规则追加name参数指定的元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_remove">selection.remove()</a></th>
				<th>从当前文档中删除选中的所有元素，并将这些元素返回</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_data">selection.data([value[, key]])</a></th>
				<th>给当前选定的所有元素依次绑定values数组中的数据</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_enter">selection.enter()</a></th>
				<th>返回输入选择</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_exit">selection.exit()</a></th>
				<th>返回需要移除的元素选择</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_filter">selection.filter(selector)</a></th>
				<th>过滤选择，返回一个新的选择只包含参数selector是true的元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_datum">selection.datum([value])</a></th>
				<th>获取或设置每个选定的元素绑定的数据</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_sort">selection.sort(comparator)</a></th>
				<th>用指定的比较函数对当前选择的元素排序，默认是d3.ascending（升序排序）</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_on">selection.on(type[, listener[, capture]])</a></th>
				<th>给当前选择的每个元素，绑定或移除指定类型的事件监听器</th>
			</tr>
			<tr>
				<th><a href="#d3_event">d3.event</a></th>
				<th>存储当前事件（如果有的话）的全局对象</th>
			</tr>
			<tr>
				<th><a href="#d3_mouse">d3.mouse(container)</a></th>
				<th>返回当前d3.event相对于指定容器container的x和y坐标</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_transition">selection.transition()</a></th>
				<th>为当前选择集开启一段过渡动画</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_select">selection.select(selector)</a></th>
				<th>对当前选中的每个元素，选中其后代中第一个匹配选择器selector的子元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_selectAll">selection.selectAll(selector)</a></th>
				<th>对当前选择的每个元素，选中所有匹配指定选择器字符串的子元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_each">selection.each(function)</a></th>
				<th>为当前选择的每个元素，调用指定的函数</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_call">selection.call(function[, arguments...])</a></th>
				<th>调用指定的函数一次，函数参数是当前的选择以及任何可选参数</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_empty">selection.empty()</a></th>
				<th>如果当前选择为空，则返回true</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_node">selection.node()</a></th>
				<th>返回当前选择的第一个非空的元素</th>
			</tr>
			<tr>
				<th><a href="#d3_selection_size">selection.size()</a></th>
				<th>返回在当前选择的元素的总个数</th>
			</tr>
		</tbody>
	</table>

	<fieldset>
		<legend id="d3_select_selector">d3.select(selector)</legend>
		<p>选择第一个与指定字符串selector相匹配的元素。如果没有匹配的元素，则返回一个空的选择对象。</p>
		<pre>
			<code class="language-javascript">
				function d3_select_selector(){
					/*选取第一个class为d3_select_selector_table的元素后面第一个tr元素的后面第一个td元素，
					增加一个selected的class名称，使其背景颜色变为橘黄色，字体颜色变为白色*/
					d3.select('.d3_select_selector_table').select('tr').select('td').classed("selected", true);
				}
			</code>
		</pre>
		<button onclick="d3_select_selector()">点击看看</button>
		<table class="d3_select_selector_table">
			<tr>
				<td>Apple</td>
				<td>Banana</td>
				<td>Watermelon</td>
			</tr>
			<tr>
				<td>Peach</td>
				<td id="d3_select_selector_test">Strawberry</td>
				<td>Pineapple</td>
			</tr>
		</table>

		<table class="d3_select_selector_table">
			<tr>
				<td>Coco</td>
				<td>Milk</td>
			</tr>
			<tr>
				<td>Green Tea</td>
				<td class="d3_select_selector_test">Beer</td>
			</tr>
		</table>

		<script type="text/javascript">
			function d3_select_selector(){
				d3.select('.d3_select_selector_table').select('tr').select('td').classed("selected", true);
			}	
		</script>
	</fieldset>

	<fieldset>
		<legend id="d3_select_node">d3.select(node)</legend>
		<p>选择指定的节点。通常用于事件监听器中使用d3.select(this)选择当前节点或者与其他第三方库整合。</p>
		<pre>
			<code class="language-javascript">
				// 给选中的class名为"d3_select_node_table"增加style
				function d3_select_node(){
					d3.select('.d3_select_node_table').on("click", function(){
						d3.select(this).style('color', 'green');
					})
				}
			</code>
		</pre>
		<button onclick="d3_select_node()">试试看</button>
		<table class="d3_select_node_table">
			<tr>
				<td>Apple</td>
				<td>Banana</td>
				<td>Watermelon</td>
			</tr>
			<tr>
				<td>Peach</td>
				<td>Strawberry</td>
				<td>Pineapple</td>
			</tr>
		</table>

		<script type="text/javascript">
			function d3_select_node(){
				d3.select('.d3_select_node_table').on("click", function(){
					d3.select(this).style('color', 'green');
				})
			}
		</script>
	</fieldset>

	<fieldset>
		<legend id="d3_selectAll_selector">d3.selectAll(selector)</legend>
		<p>选择所有与指定参数selector相匹配的元素，选择的结果是一个数组，这些元素会按照文档的遍历顺序（从上到下）存入数组。如果当前文档中没有匹配的元素则返回空的选择</p>
		<pre>
			<code class="language-javascript">
				// 选择class名为"d3_selectAll_selector_table"中所有td标签，使其背景色为橘黄色
				function d3_selectAll_selector(){
					d3.select('.d3_selectAll_selector_table').selectAll('td').style('background-color','#ff5c00');
				}
			</code>
		</pre>
		<button onclick="d3_selectAll_selector()">试试看</button>
		<table class="d3_selectAll_selector_table">
			<tr>
				<td>Apple</td>
				<td>Banana</td>
				<td>Watermelon</td>
			</tr>
			<tr>
				<td>Peach</td>
				<td>Strawberry</td>
				<td>Pineapple</td>
			</tr>
		</table>

		<script type="text/javascript">
			function d3_selectAll_selector(){
				d3.select('.d3_selectAll_selector_table').selectAll('td').style('background-color','#ff5c00');
			}
		</script>
	</fieldset>

	<fieldset>
		<legend id="d3_selectAll_nodes">d3.selectAll(nodes)</legend>
		<p>选择指定的结点数组。</p>
		<p>选择的结果是一个元素数组。D3在这个数组上绑定了额外的方法可以操作这些元素，例如：为所有选中的元素设置属性值。</p>
		<p>选择结果是分组的，而不是一个一维数组，元素数值中的每个值都是一个子数组。这保留了子选择的层次结构，所以当selectAll只选中一个元素时返回的结果看起来像[[node]]而不是[node]。</p>
		<pre>
			<code class="language-javascript">
				// 在一个事件监听器中，选择当前元素的所有子元素
				d3.selectAll(this.childNodes);
				// 选择文档中所有的超链接
				d3.selectAll(document.links); 
			</code>
		</pre>
		<button onclick="d3_selectAll_nodes()">试试看</button>
		<p class="d3_selectAll_nodes_test">
			按F12在console后台查看
		</p>
		<script type="text/javascript">
			function d3_selectAll_nodes(){
				console.log(d3.selectAll(document.links));
			}
		</script>
	</fieldset>

	<fieldset>
		<legend id="d3_selection_attr">selection.attr(name[, value])</legend>
		<p>若指定了value参数，则用来设置所有选中元素中指定属性的值，否则返回选择集中一个非空元素中指定属性的值。</p>
		<p>value可以是常数，也可以是函数，若是函数，则这个函数有两个参数：d代表当前元素绑定的数据，i代表当前元素在选中元素集合中的 索引。<pre style="color: red;">若value为null则移除指定的属性。</pre></p>
		<pre>
			<code class="language-javascript">
				function d3_selection_attr(){
					// 绘制矩形的数据
					var dataset = [5, 10, 15, 20, 25];

					// 创建SVG
					var svg = d3.select(".d3_selection_attr_test").append("svg").attr('width', '150px').attr('height','100px');

					// 创建矩形
					var rects = svg.selectAll("rect")
									.data(dataset)
									.enter()
									.append('rect')
									.attr({
										'x':function(d, i){return i*160/dataset.length;}, //相对位移（横轴）i*160/dataset.length px
										'y':function(d, i){return 40;}, //相对位移（纵轴）40px
										'width': function(d, i){return i;},
										'height': function(d, i){return dataset[i]},
									})
									.attr('fill', 'steelblue');
				}
			</code>
		</pre>
		<button onclick="d3_selection_attr()">试试看</button>
		<p class="d3_selection_attr_test">
			
		</p>
		<script type="text/javascript">
			function d3_selection_attr(){
				// 绘制矩形的数据
				var dataset = [5, 10, 15, 20, 25];

				// 创建SVG
				var svg = d3.select(".d3_selection_attr_test").append("svg").attr('width', '150px').attr('height','100px');

				// 创建矩形
				var rects = svg.selectAll("rect")
								.data(dataset)
								.enter()
								.append('rect')
								.attr({
									'x':function(d, i){return i*160/dataset.length;}, //相对位移（横轴）i*160/dataset.length px
									'y':function(d, i){return 40;}, //相对位移（纵轴）40px
									'width': function(d, i){return i;},
									'height': function(d, i){return dataset[i]},
								})
								.attr('fill', 'steelblue');
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_classed">
		<legend>selection.classed(name[, value])</legend>
		<p>若没有指定value参数，则返回与name参数匹配的第一个非空元素是否绑定了指定的css类，true表示绑定，false表示未绑定；如果指定了value参数，则值为true时绑定name参数指定的css类，为false时移除这个css类。</p>
		<p>主要用来添加、移除或切换css类，value参数可以是一个布尔值或函数，若是函数，则这个函数有两个参数：d代表当前元素绑定的数据，i代表当前元素在选择结果集合中的索引。在函数内部可以使用this关键字引用当前元素，函数返回布尔类型的值。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_classed(){
					// 绘制矩形的数据
					var dataset = [15, 20, 25, 30, 35];
					// 创建SVG
					var svg = d3.select('#d3_selection_classed')
								.append('svg')
								.attr('width', '200px')
								.attr('height', '100px');
					// 创建矩形
					var rects = svg.selectAll('rect')
								.data(dataset)
								.enter()
								.append('rect')
								.attr({
									'x': function(d, i){return i*160/dataset.length;},
									'y': function(d, i){return 20;},
									'width': function(d, i){return dataset[i];},
									'height': function(d, i){return dataset[i];}
								});

					// 使用函数值绑定元素的css类
					rects.classed({
						'odd': function(d, i){return i%2==0 ? true : false;},
						'even': function(d, i){return i%2==0 ? false : true;}
					});

					// 切换矩形的css类
					rects.on('click', function() {
						var rect = d3.select(this);
						if(rect.classed('stroke opacity')){ // 取得元素是否绑定指定名称的css类
							rect.classed('stroke opacity', false); // 移除绑定的css类
						}else{
							rect.classed('stroke opacity', true); // 给元素绑定css类
						}
					});
				}
			</code>
		</pre>
		<button onclick="d3_selection_classed()">试试看</button>
		<script type="text/javascript">
			function d3_selection_classed(){
				// 绘制矩形的数据
				var dataset = [15, 20, 25, 30, 35];
				// 创建SVG
				var svg = d3.select('#d3_selection_classed')
							.append('svg')
							.attr('width', '200px')
							.attr('height', '100px');
				// 创建矩形
				var rects = svg.selectAll('rect')
							.data(dataset)
							.enter()
							.append('rect')
							.attr({
								'x': function(d, i){return i*160/dataset.length;},
								'y': function(d, i){return 20;},
								'width': function(d, i){return dataset[i];},
								'height': function(d, i){return dataset[i];}
							});

				// 使用函数值绑定元素的css类
				rects.classed({
					'odd': function(d, i){return i%2==0 ? true : false;},
					'even': function(d, i){return i%2==0 ? false : true;}
				});

				// 切换矩形的css类
				rects.on('click', function() {
					var rect = d3.select(this);
					if(rect.classed('stroke opacity')){ // 取得元素是否绑定指定名称的css类
						rect.classed('stroke opacity', false); // 移除绑定的css类
					}else{
						rect.classed('stroke opacity', true); // 给元素绑定css类
					}
				});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_style">
		<legend>selection.style(name[, value[, priority]])</legend>
		<p>返回选择集中第一个非空元素中名为name的样式，或设置选择集中所有元素中名为name的样式值为value指定的值。参数priority用来设置优先级，默认为null。</p>
		<p>value参数可以为常数也可为函数，若为函数，则此函数有两个参数：d为当前元素已绑定的数据，i为当前元素在元素集中的索引。在函数内部也可以使用this关键字引用当前元素。若value的值为null，则会删除name参数指定的样式。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_style(){
					//绘制矩形的数据
					var dataset = [15, 20, 25, 30, 35];
					//创建SVG
					var svg = d3.select('#d3_selection_style')
								.append('svg')
								.attr('width', '500px')
								.attr('height', '100px');
					// 创建矩形
					var rects = svg.selectAll('rect')
								.data(dataset)
								.enter()
								.append('rect')
								.attr({
									'x': function(d, i){return i*160/dataset.length;},
									'y': function(d, i){return 20;},
									'width': function(d, i){return dataset[i];},
									'height': function(d, i){return dataset[i];}
								})
								.attr('fill', 'balck');

					//设置其属性
					rects.style({
						'stroke-width': '5px',
						'stroke': function(d, i){return 'rgb('+2*d+','+2*d+','+d+')';},
						'fill': function(d, i){return 'rgb('+5*d+','+10*d+','+d+')';}
					});

				}
			</code>
		</pre>
		<button onclick="d3_selection_style()">试试看</button>
		<script type="text/javascript">
			function d3_selection_style(){
				//绘制矩形的数据
				var dataset = [15, 20, 25, 30, 35];
				//创建SVG
				var svg = d3.select('#d3_selection_style')
							.append('svg')
							.attr('width', '500px')
							.attr('height', '100px');
				// 创建矩形
				var rects = svg.selectAll('rect')
							.data(dataset)
							.enter()
							.append('rect')
							.attr({
								'x': function(d, i){return i*160/dataset.length;},
								'y': function(d, i){return 20;},
								'width': function(d, i){return dataset[i];},
								'height': function(d, i){return dataset[i];}
							})
							.attr('fill', 'balck');

				//设置其属性
				rects.style({
					'stroke-width': '5px',
					'stroke': function(d, i){return 'rgb('+2*d+','+2*d+','+d+')';},
					'fill': function(d, i){return 'rgb('+5*d+','+10*d+','+d+')';}
				});

			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_property">
		<legend>selection.property(name[, value])</legend>
		<p>一些HTML元素具有特殊的内置属性，使用标准的属性或样式操作符是访问不到的。如：表单中文本字段（Text）放入value字符串属性、复选框（checkboxes）的checked布尔型属性。可以使用property操作符来获取或设置。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_property(){
					d3.select('#d3_selection_property_text_id')
						.property('value', function(){
							return d3.select(this).property('id'); // 获取id属性的值
						}); //设置文本的value属性为此元素的id值
					d3.select('#d3_selection_property_checkbox_id')
						.property('checked', true);  //设置复选框的checked属性
				}
			</code>
		</pre>
		<button onclick="d3_selection_property()">试试看</button>
		<br>
		<input type="text" id="d3_selection_property_text_id" />
		<br>
		<input type="checkbox" id="d3_selection_property_checkbox_id" />
		.property
		<br>
		<script type="text/javascript">
			function d3_selection_property(){
				d3.select('#d3_selection_property_text_id')
					.property('value', function(){
						return d3.select(this).property('id'); // 获取id属性的值
					}); //设置文本的value属性为此元素的id值
				d3.select('#d3_selection_property_checkbox_id')
					.property('checked', true);  //设置复选框的checked属性
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_text">
		<legend>selection.text([value])</legend>
		<p>返回第一个非空元素的文本内容，或设置选择集中所有元素的文本内容为指定的值。</p>
		<p>文本操作符基于textContent属性，设置文本内容将取代任何现有的子元素。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_text(){
					d3.select('.d3_selection_text_p').text("selection.text([value])");  //设置元素的文本
					d3.select('.d3_selection_text_p')
						.text(function(){
							return "new text: "+d3.select(this).text();
						}); //设置元素的文本
				}
			</code>
		</pre>
		<button onclick="d3_selection_text()">试试看</button>
		<p class="d3_selection_text_p" style="border: 1px solid #333;"></p>
		<script type="text/javascript">
			function d3_selection_text(){
				d3.select('.d3_selection_text_p').text("selection.text([value])");  //设置元素的文本
				d3.select('.d3_selection_text_p')
					.text(function(){
						return "new text: "+d3.select(this).text();
					}); //设置元素的文本
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_html">
		<legend>selection.html([value])</legend>
		<p>html操作符基于innerHTML属性，设置内部HTML的内容为value参数指定的值并取代任何已有的子元素。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_html(){
					d3.select('.d3_selection_html_p').html('<h1>大家好！我是h1！</h1>'); //设置innerHTML的内容
					d3.select('.d3_selection_html_p')
						.html(function(d, i){
							// 用函数设置innerHTML的内容
							var old = d3.select(this).html(); // 获取innerHTML的内容
							var newHTML = old + "<h2>大家好，我是h2！</h2>";
							return newHTML;
						});
				}
			</code>
		</pre>
		<button onclick="d3_selection_html()">试试看</button>
		<p class="d3_selection_html_p" style="border: 1px solid #333;"></p>
		<script type="text/javascript">
			function d3_selection_html(){
				d3.select('.d3_selection_html_p').html('<h1>大家好！我是h1！</h1>'); //设置innerHTML的内容
				d3.select('.d3_selection_html_p')
					.html(function(d, i){
						// 用函数设置innerHTML的内容
						var old = d3.select(this).html(); // 获取innerHTML的内容
						var newHTML = old + "<h2>大家好，我是h2！</h2>";
						return newHTML;
					});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_append">
		<legend>selection.append(name)</legend>
		<p>在当前选择集的最后追加指定名称的子元素，返回的新选择集包含这个新追加的子元素。每个新元素都继承了元素集已绑定的数据。这个name参数可以被指定为一个常量字符串或一个函数，如果是函数的话，则返回追加的DOM元素。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_append(){
					// 向id为d3_selection_append的标签追加子元素svg
					var svg = d3.select('#d3_selection_append').append('svg');
					// 向svg元素追加有svg命名空间的rect子元素
					svg.append('svg: rect')
						.attr({
							'x': 10,
							'y': 10,
							'width': 100,
							'height': 40,
							'fill': 'orange'
						});
				}
			</code>
		</pre>
		<button onclick="d3_selection_append()">试试看</button>
		<script type="text/javascript">
			function d3_selection_append(){
				// 向id为d3_selection_append的标签追加子元素svg
				var svg = d3.select('#d3_selection_append').append('svg');
				// 向svg元素追加有svg命名空间的rect子元素
				svg.append('svg:rect')
					.attr({
						'x': 10,
						'y': 10,
						'width': 100,
						'height': 120,
						'fill': 'orange'
					});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_insert">
		<legend>selection.insert(name[, before])</legend>
		<p>如果指定了befoer参数，则在选择集中的before参数指定的元素前添加name参数指定的元素；如果未指定before参数或没有子元素匹配before参数，则直接使用selection.append的规则追加name参数指定的元素。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_insert(){
					//插入SVG
					var svg = d3.select('#d3_selection_insert').insert("svg");
					//插入rect元素
					svg.insert('svg:rect')
						.attr({
							'x': 10,
							'y': 100,
							'width': 100,
							'height': 40,
							'fill': 'forestgreen'
						});
					//在rect元素前插入circle元素
					svg.insert('circle', 'rect')
						.attr({
							'cx': 60,
							'cy': 75,
							'r': 25,
							'fill': 'slateblue'
						});
				}
			</code>
		</pre>
		<button onclick="d3_selection_insert()">试试看</button>
		<script type="text/javascript">
			function d3_selection_insert(){
				//插入SVG
				var svg = d3.select('#d3_selection_insert').insert("svg");
				//插入rect元素
				svg.insert('svg:rect')
					.attr({
						'x': 10,
						'y': 100,
						'width': 100,
						'height': 40,
						'fill': 'forestgreen'
					});
				//在rect元素前插入circle元素
				svg.insert('circle', 'rect')
					.attr({
						'cx': 60,
						'cy': 75,
						'r': 25,
						'fill': 'slateblue'
					});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_remove">
		<legend>selection.remove()</legend>
		<p>从当前文档删除选择中所有的元素，并将这些元素返回。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_remove(){
					//除掉黑块
					var removed = d3.select('.d3_selection_remove_div').remove();
					console.log(removed);
				}
			</code>
		</pre>
		<button onclick="d3_selection_remove()">试试看</button>
		<div class="d3_selection_remove_div" style="width: 100px; height: 100px; background-color: #333;"></div>
		<script type="text/javascript">
			function d3_selection_remove(){
				//除掉上面的黑块
				var removed = d3.select('.d3_selection_remove_div').remove();
				console.log(removed);
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_data">
		<legend>selection.data([values[, key]])</legend>
		<p>给当前选定的所有元素依次绑定values数组中的数据。</p>
		<p>values参数：是一组数据值（例如：数字或对象）或返回一组值的函数。</p>
		<p>key参数：若没有指定key参数，则values数组的第一个数据值被分配给选择集中的第一个元素，第二个数据值分配给选择集中的第二个元素，以此类推。当数据被分配给一个元素之后，就被存储在元素的"__data__"属性中，从而使数据可以重用。</p>
		<p>.data()操作的结果是更新选择，即选择的DOM元素已成功和数据元素绑定。enter和exit操作符也会更新选择，分别对应于添加和删除数据节点。</p>
		<p>key函数用来控制数据是如何连接元素的，它被新数据数组中的每个数据元素调用一次，并再次被选择中的每个DOM元素调用一次。这两种情况下的key都有两个参数：数据d和索引i。当key函数用于数据元素时，key函数中的this关键字代表数据数组中的当前数据；当key函数用于选择中的元素时，this代表当前DOM元素。key函数基于前面绑定的数据返回一个字符串，用来连接数据和DOM元素。</p>
		<p>例如：假设每个数据都有一个唯一的字段name，则数据连接可以被指定为.data(data, function(d){return d.name;})。</p>
		<p>values数组也可以给选择集中的每个组指定数据，即values可以是多维数组。因此，如果选择集具有多个组（例如：d3.selectAll之后再接一个selection.selectAll），可以指定values参数为函数，返回值是一个子数组。这个函数有两个参数：d代表当前元素已绑定的数据，i代表当前元素在元素集中的索引。在函数内部用this关键字指向当前元素。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_data(){
					//定义一个二维数组
					var matrix = [
					[1, 2, 3, 4],
					[5, 6, 7, 8],
					[9, 10, 11, 12],
					[13, 14, 15, 16]
					];
					var tr = d3.select('#d3_selection_data').insert('table').selectAll('tr')
								.data(matrix)  //绑定二维数组，给表格的每一行传递一个子数组
								.enter()
								.append('tr');
					var td = tr.selectAll('td')
								.data(function(d, i){return d;})  //绑定子数组，给每行的每列传递子数组
								.enter()
								.append('td')
								.text(function(d, i){return d;});
				}
			</code>
		</pre>
		<button onclick="d3_selection_data()">试试看</button>
		<script type="text/javascript">
			function d3_selection_data(){
				//定义一个二维数组
				var matrix = [
				[1, 2, 3, 4],
				[5, 6, 7, 8],
				[9, 10, 11, 12],
				[13, 14, 15, 16]
				];
				var tr = d3.select('#d3_selection_data').insert('table').selectAll('tr')
							.data(matrix)  //绑定二维数组，给表格的每一行传递一个子数组
							.enter()
							.append('tr');
				var td = tr.selectAll('td')
							.data(function(d, i){return d;})  //绑定子数组，给每行的每列传递子数组
							.enter()
							.append('td')
							.text(function(d, i){return d;});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_enter">
		<legend>selection.enter()</legend>
		<p>返回输入选择。也就是每个数据元素的占位节点。这个占位节点在当前DOM元素中还不存在。这个操作符只在由data操作符返回的更新选择中定义。此外，enter选择只定义了追加（append）、插入（insert）、选择（select）、调用（call）这四个可用的操作符。在修改元素内容之前必须使用这些操作符实例化输入元素。输入选择也支持empty和size操作符。</p>
		<pre>
			<code class="language-javascript">
				function d3_selection_enter(){
					//生成text元素的数据
					var dataset = ['text1', 'text2', 'text3', 'text4'];
					//新增元素
					d3.select('#d3_selection_enter').insert('svg').attr('width', '100px').attr('height', '100px').selectAll('text')
						.data(dataset)  //绑定数据
						.enter()   //返回新元素的占位符
						.append('text')  //新增新元素
						.attr({
							'x': '20',
							'y': function(d, i){return 20+20*i;},
							'fill': 'steelblue'
						})
						.text(function(d, i){return d;});
				}
			</code>
		</pre>
		<button onclick="d3_selection_enter()">试试看</button>
		<script type="text/javascript">
			function d3_selection_enter(){
				//生成text元素的数据
				var dataset = ['text1', 'text2', 'text3', 'text4'];
				//新增元素
				d3.select('#d3_selection_enter').insert('svg').attr('width', '100px').attr('height', '100px').selectAll('text')
					.data(dataset)  //绑定数据
					.enter()   //返回新元素的占位符
					.append('text')  //新增新元素
					.attr({
						'x': '20',
						'y': function(d, i){return 20+20*i;},
						'fill': 'steelblue'
					})
					.text(function(d, i){return d;});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_exit">
		<legend>selection.exit()</legend>
		<p>返回需要移除的元素选择。exit操作符只是返回一个退出选择的引用，需要手动调用.remove()来删除选择的节点。即exit执行后元素在当前选择中不存在，但是在当前DOM文档中存在。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_exit(){
				//生成6个div标签，内容是1,2,3,4,5,6
				d3.select('#d3_selection_exit').selectAll('div')
					.data([1, 2, 3, 4, 5, 6])
					.enter()
					.append('div')
					.text(function(d){return d;});
				//更新绑定的数组
				var divs = d3.select('#d3_selection_exit').selectAll('div')
							.data([4, 5, 6, 7, 8, 9], function(d){return d;});
				//用新数组生成div标签
				divs.enter()
					.append('div')
					.text(function(d){return d;});
				//将第一个数组中退出的数据对应的元素删除
				divs.exit().remove();
				//增加索引属性
				d3.selectAll('div').attr('index', function(d, i){return i;});

			}
			</code>
		</pre>
		<button onclick="d3_selection_exit()">试试看</button>
		<script type="text/javascript">
			function d3_selection_exit(){
				//生成6个div标签，内容是1,2,3,4,5,6
				d3.select('#d3_selection_exit').selectAll('div')
					.data([1, 2, 3, 4, 5, 6])
					.enter()
					.append('div')
					.text(function(d){return d;});
				//更新绑定的数组
				var divs = d3.select('#d3_selection_exit').selectAll('div')
							.data([1, 4, 5, 6, 7, 8, 9], function(d){return d;});
				//用新数组生成div标签
				divs.enter()
					.append('div')
					.text(function(d){return d;});
				//将第一个数组中退出的数据对应的元素删除
				divs.exit().remove();
				//增加索引属性
				d3.selectAll('div').attr('index', function(d, i){return i;});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_filter">
		<legend>selection.filter(selector)</legend>
		<p>过滤选择，返回一个新的选择只包含参数selector是true的元素。selector可以是一个函数或选择字符串。与其他操作符一样，函数有两个参数：d为当前元素已绑定的数据，i是当前元素在元素集中的索引。在函数内部可以使用this引用当前元素。过滤器只能被绑定了DOM元素的选择调用，例如：由append和insert返回的选择。如果只需要将元素和数据的子集绑定，可以在data操作符中调用数组的内置数组过滤器。D3的过滤器在返回选择中不会保留原来选择的索引，它只返回移除元素的副本；如果需要保留索引，请用.select()函数。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_filter(){
				//生成text元素的数据
				var dataset = ['text1', 'text2', 'text3', 'text4'];
				//新增元素
				d3.select('#d3_selection_filter').insert('svg').attr('width', '100px').attr('height', '100px').selectAll('text')
					.data(dataset)
					.enter()  //返回新元素的占位符
					.append('text')  //新增新元素
					.attr({
						'x': '20',
						'y': function(d, i){return 20+20*i;},
						'fill': 'tomato'
					})
					.text(function(d, i){return d;});
				//过滤奇数索引的text，并设置其文本填充色为blue
				d3.select('#d3_selection_filter').select('svg').selectAll('text')
					.filter(function(d, i){return i%2==0;})
					.style('fill', 'royalblue');
			}
			</code>
		</pre>
		<button onclick="d3_selection_filter()">试试看</button>
		<script type="text/javascript">
			function d3_selection_filter(){
				//生成text元素的数据
				var dataset = ['text1', 'text2', 'text3', 'text4'];
				//新增元素
				d3.select('#d3_selection_filter').insert('svg').attr('width', '100px').attr('height', '100px').selectAll('text')
					.data(dataset)
					.enter()  //返回新元素的占位符
					.append('text')  //新增新元素
					.attr({
						'x': '20',
						'y': function(d, i){return 20+20*i;},
						'fill': 'tomato'
					})
					.text(function(d, i){return d;});
				//过滤奇数索引的text，并设置其文本填充色为blue
				d3.select('#d3_selection_filter').select('svg').selectAll('text')
					.filter(function(d, i){return i%2==0;})  //过滤奇数索引
					.style('fill', 'royalblue');
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_datum">
		<legend>selection.datum([value])</legend>
		<p>获取或设置每个选定的元素绑定的数据。与selection.data方法不同的是，这个方法不计算连接（join），因此不能使用enter或exit来选择。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_datum(){
				d3.select('#d3_selection_datum').selectAll('div')
					.datum(function(){return this.dataset;})  //获取HTML5自定义数据属性
					.text(function(d){return d.username;});  //使用获取的数据设置文本的值

				d3.select('#d3_selection_datum').selectAll('p').filter(function(d, i){return i==1;})
					.datum(function(){return d3.select('#d3_selection_datum').select('script').text;})
					.text(function(d){return d;});
			}
			</code>
		</pre>
		<button onclick="d3_selection_datum()">试试看</button>
		<div data-username='D3 user'></div>
		<div data-username='D3 fans'></div>
		<p style="border: 1px solid #333;"></p>
		<script type="text/javascript">
			function d3_selection_datum(){
				d3.select('#d3_selection_datum').selectAll('div')
					.datum(function(){return this.dataset;})  //获取HTML5自定义数据属性
					.text(function(d){return d.username;});  //使用获取的数据设置文本的值

				d3.select('#d3_selection_datum').selectAll('p').filter(function(d, i){return i==1;})
					.datum(function(){return d3.select('#d3_selection_datum').select('script').text;})
					.text(function(d){return d;});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_sort">
		<legend>selection.sort(comparator)</legend>
		<p>用指定的比较函数对当前选择的元素排序，默认是d3.ascending（升序）。比较器函数是通过传入两个数据元素进行比较的，若返回值为负，则a在b之前。这种排序不能保证是稳定的，但是可以保证与浏览器中内置的数组排序方法具有相同的行为。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_sort(){
				//一维数组数据
				var dataset = [
				{name: 'A2', value: 2},
				{name: 'A1', value: 1},
				{name: 'A5', value: 5},
				{name: 'A4', value: 4},
				];
				//新增元素
				d3.select('#d3_selection_sort')
					.append('svg')
					.attr('width', '100px')
					.attr('height', '100px')
					.selectAll('text')
					.data(dataset) //绑定数据
					.enter()  //返回新元素的占位符
					.append('text')  //新增新元素
					.attr({
						'x': '13',
						'y': function(d, i){return 20+20*i;}
					})
					.text(function(d, i){return d.name;});
				//按照绑定数据的value属性进行排序
				var sort = function(){
					d3.select('#d3_selection_sort')
						.select('svg')
						.selectAll('text')
						.sort(function(a, b){return a.value - b.value;})
						.attr({
							'x': '13',
							'y': function(d, i){return 20+20*i;}
						})
						.text(function(d, i){return d.name;});
				};
				//点击按钮进行排序
				d3.select('#d3_selection_sort').insert('button').text('排序').on('click', sort);
			}
			</code>
		</pre>
		<button onclick="d3_selection_sort()">试试看</button>
		<script type="text/javascript">
			function d3_selection_sort(){
				//一维数组数据
				var dataset = [
				{name: 'A2', value: 2},
				{name: 'A1', value: 1},
				{name: 'A5', value: 5},
				{name: 'A4', value: 4},
				];
				//新增元素
				d3.select('#d3_selection_sort')
					.append('svg')
					.attr('width', '100px')
					.attr('height', '100px')
					.selectAll('text')
					.data(dataset) //绑定数据
					.enter()  //返回新元素的占位符
					.append('text')  //新增新元素
					.attr({
						'x': '13',
						'y': function(d, i){return 20+20*i;}
					})
					.text(function(d, i){return d.name;});
				//按照绑定数据的value属性进行排序
				var sort = function(){
					d3.select('#d3_selection_sort')
						.select('svg')
						.selectAll('text')
						.sort(function(a, b){return a.value - b.value;})
						.attr({
							'x': '13',
							'y': function(d, i){return 20+20*i;}
						})
						.text(function(d, i){return d.name;});
				};
				//点击按钮进行排序
				d3.select('#d3_selection_sort').insert('button').text('排序').on('click', sort);
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_on">
		<legend>selection.on(type[, listener[, capture]])</legend>
		<p>给当前选择的每个元素，绑定或移除指定类型的事件监听器。type是一个字符串类型的事件名称，如：‘click’、‘mousehover’、‘submit’等任何支持的DOM事件。指定的listener是一个函数，有两个参数：d代表当前元素已绑定的数据，i代表当前元素在元素集中的索引。在函数内部可以使用this引用当前DOM元素。使用全局事件对象d3.event可以在监听器内访问当前事件，事件监听器的返回值将被忽略。
		<br>
		如果元素已绑定了相同类型的事件监听器，则先移除现有监听器再添加新的监听器。如果要为相同类型的事件注册多个监听器，类型后跟一个可选的命名空间，如'click.foo'和'click.bar'。
		<br>
		当listener值为null时可以删除一个监听器。要删除特定事件类型的所有监听器，可以使用这样的事件名称：selection.on('foo', null);
		<br>
		可选参数capture对应于W3C的useCapture标志，事件是沿着树向上冒泡的。
		如果未指定监听器，仅仅指定类型，则返回当前分配的监听器（如果有的话）。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_on(){
				//一维数组数据
				var dataset = [1, 2, 3, 4, 5];
				//新增元素
				d3.select('#d3_selection_on')
					.append('svg')
					.attr('width', '100px')
					.attr('height', '100px')
					.selectAll('text')
					.data(dataset)
					.enter()
					.append('text')
					.attr({
						'x': 13,
						'y': function(d, i){return 20+20*i;}
					})
					.text(function(d, i){return 'old:'+d;});
				//单击按钮更改文本内容
				d3.select('#d3_selection_on').insert('button').text('点击').on('click', function(){
					d3.select('#d3_selection_on').select('svg').selectAll('text').text(function(d, i){return 'new:'+d*3;});
				});
			}
			</code>
		</pre>
		<button onclick="d3_selection_on()">试试看</button>
		<script type="text/javascript">
			function d3_selection_on(){
				//一维数组数据
				var dataset = [1, 2, 3, 4, 5];
				//新增元素
				d3.select('#d3_selection_on')
					.append('svg')
					.attr('width', '100px')
					.attr('height', '100px')
					.selectAll('text')
					.data(dataset)
					.enter()
					.append('text')
					.attr({
						'x': 13,
						'y': function(d, i){return 20+20*i;}
					})
					.text(function(d, i){return 'old:'+d;});
				//单击按钮更改文本内容
				d3.select('#d3_selection_on').insert('button').text('点击').on('click', function(){
					d3.select('#d3_selection_on').select('svg').selectAll('text').text(function(d, i){return 'new:'+d*3;});
				});
			}
		</script>
	</fieldset>

	<fieldset id="d3_event">
		<legend>d3.event</legend>
		<p>存储当前事件（如果有的话）的全局对象。这个全局对象是通过on操作符在事件监听器回调中注册的。当监听器在finally块被通知后当前事件便被重置。监听器函数与其他操作符函数有相同的形式，参数有d和i。</p>
		<pre>
			<code class="language-javascript">
			function d3_event(){
				var svg = d3.select('#d3_event').append('svg').attr({'width':'200px','height':'100px'});
				var text1 = svg.append('text').attr({'x':'20','y':'20'});
				var text2 = svg.append('text').attr({'x':'40','y':'40'});
				//比较d3.mouse和d3.event的偏移坐标(当前鼠标位置相对于父容器的偏移坐标)
				svg.on('mousemove', function(d, i){
					console.log(d3.event);
					var pos1 = 'd3.mouse pos: ' + d3.mouse(d3.select('#d3_event')[0][0]);
					var pos2 = 'd3.event pos: ' + d3.event.offsetX + ', ' + d3.event.offsetY;
					text1.text(pos1);
					text2.text(pos2);
				});
			}
			</code>
		</pre>
		<button onclick="d3_event()">试试看</button>
		<script type="text/javascript">
			function d3_event(){
				var svg = d3.select('#d3_event').append('svg').attr({'width':'200px','height':'100px'});
				var text1 = svg.append('text').attr({'x':'20','y':'20'});
				var text2 = svg.append('text').attr({'x':'40','y':'40'});
				//比较d3.mouse和d3.event的偏移坐标(当前鼠标位置相对于父容器的偏移坐标)
				svg.on('mousemove', function(d, i){
					console.log(d3.event);
					var pos1 = 'd3.mouse pos: ' + d3.mouse(d3.select('#d3_event')[0][0]);
					var pos2 = 'd3.event pos: ' + d3.event.offsetX + ', ' + d3.event.offsetY;
					text1.text(pos1);
					text2.text(pos2);
				});
			}
		</script>
	</fieldset>

	<fieldset id="d3_mouse">
		<legend>d3.mouse(container)</legend>
		<p>返回当前d3.event相对于指定容器container的x和y坐标。该容器可以是一个HTML或SVG容器元素，如：svg:g或svg:svg。返回的坐标是一个包含两个元素的数组[x,y]。示例见<a href="#d3_event">d3.event</a></p>
	</fieldset>

	<fieldset id="d3_selection_transition">
		<legend>selection.transition()</legend>
		<p>为当前选择集开启一段过滤动画。过滤的行为和选择类似，只是属性的变化会更平滑地随时间推移，而不是瞬间完成。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_transition(){
				d3.select('#d3_selection_transition').append('svg').attr({'width':'200px','height':'200px'});
				d3.select('#d3_selection_transition').select('svg').append('circle').attr({
					'cx': '100',
					'cy': '100',
					'r': '40',
					'fill': 'orange'
				});
				//开启动画，并设置动画结束时填充色为blue
				d3.select('#d3_selection_transition').select('svg').select('circle')
					.transition()
					.attr('fill', 'blue');
			}
			</code>
		</pre>
		<button onclick="d3_selection_transition()">试试看</button>
		<script type="text/javascript">
			function d3_selection_transition(){
				d3.select('#d3_selection_transition').append('svg');
				d3.select('#d3_selection_transition').select('svg').append('circle').attr({
					'cx': '100',
					'cy': '100',
					'r': '40',
					'fill': 'orange'
				});
				//开启动画，并设置动画结束时填充色为blue
				d3.select('#d3_selection_transition').select('svg').select('circle')
					.on('mousemove', function(){
						d3.select(this).transition().attr('fill', 'blue');
					});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_select">
		<legend>selection.select(selector)</legend>
		<p>对当前选中的每个元素，选中其后代中第一个匹配选择器selector的子元素。如果当前元素没有元素匹配指定的选择器，当前索引处的元素在返回的选择中将是空值null。操作符（除了selection.data）自动跳过null元素，从而保持了现有选择的索引。
		<br>
		如果当前元素具有相关联的数据，该数据由返回的子选择继承，并且自动绑定到新选定的元素。如果有多个元素匹配选择器，只有在文档遍历顺序中第一个匹配的元素会被选中。
		<br>
		选择器selector也可以被指定为一个函数，返回值是一个元素或null（如果没有匹配的元素）。在这种情况下，指定的选择器以和其他操作函数同样的方式被调用，这个函数有两个参数：d代表当前元素已绑定的数据，i代表当前元素在元素集中的索引。在函数内部也可以用this引用当前元素。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_select(){
				//选择所有的行，并选择每行的第一列，设置选中元素的背景色为橘黄色
				d3.select('#d3_selection_select').selectAll('tr').select('td').style('background-color', 'orange');
			}
			</code>
		</pre>
		<button onclick="d3_selection_select()">试试看</button>
		<div style="width:300px;height:220px;">
			<table>
				<tr>
					<td>苹果</td>	
					<td>香蕉</td>
					<td>西瓜</td>
				</tr>
				<tr>
					<td>桃子</td>	
					<td id="test">草莓</td>
					<td>菠萝</td>
				</tr>
			</table>

			<table>
				<tr>
					<td>可乐</td>
					<td>牛奶</td>
				</tr>
				<tr>
					<td>绿茶</td>
					<td class="test">啤酒</td>
				</tr>
			</table>
		</div>
		<script type="text/javascript">
			function d3_selection_select(){
				//选择所有的行，并选择每行的第一列，设置选中元素的背景色为橘黄色
				d3.select('#d3_selection_select').selectAll('tr').select('td').style('background-color', 'orange');
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_each">
		<legend>selection.each(function)</legend>
		<p>为当前选择的每个元素，调用指定的函数，这个函数可以有两个参数：d代表当前元素已绑定的数据，i代表当前元素在元素集中的索引。在函数内部可以用this。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_each(){
				//添加圆圈使用的数据集
				var dataset = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
				//颜色比例尺
				var color = d3.scale.category20();
				//使用数据集添加10个圆圈
				d3.select('#d3_selection_each').append('svg').selectAll('circle')
					.data(dataset)
					.enter()
					.append('circle');
				//使用each函数为每个圆圈设置属性
				d3.select('#d3_selection_each').selectAll('circle')
					.each(function(d){
						d3.select(this).attr({
							'cx': function(d){return 20*d;},
							'cy': '100',
							'r': function(d){return 3*d;},
							'fill': color(d)
						});
					});
			}
			</code>
		</pre>
		<button onclick="d3_selection_each()">试试看</button>
		<script type="text/javascript">
			function d3_selection_each(){
				//添加圆圈使用的数据集
				var dataset = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
				//颜色比例尺
				var color = d3.scale.category20();
				//使用数据集添加10个圆圈
				d3.select('#d3_selection_each').append('svg').selectAll('circle')
					.data(dataset)
					.enter()
					.append('circle');
				//使用each函数为每个圆圈设置属性
				d3.select('#d3_selection_each').selectAll('circle')
					.each(function(d){
						d3.select(this).attr({
							'cx': function(d){return 20*d;},
							'cy': '100',
							'r': function(d){return 3*d;},
							'fill': color(d)
						});
					});
			}
		</script>
	</fieldset>

	<fieldset id="d3_selection_call">
		<legend>selection.call(function[, argument...])</legend>
		<p>调用指定的函数一次，函数参数是当前的选择以及任何可选参数。无论指定函数的返回值是什么，call操作符总是返回当前的选择。call操作符的作用与手动调用函数相同，但它便于使用方法链。在被调用的函数中，this代表当前的选择。</p>
		<pre>
			<code class="language-javascript">
			function d3_selection_call(){
				var circle = d3.select('#d3_selection_call').append('svg').append('circle').attr({
					'cx': '100',
					'cy': '100',
					'r': '40'
				});
				var rect = d3.select('#d3_selection_call').select('svg').append('svg:rect').attr({
					'x': '10',
					'y': '50',
					'width': '40',
					'height': '100'
				});
				//定义色彩填充方法
				function fill(ele, fill){
					this.style('fill', fill);
				}
				//使用call函数调用fill函数填充颜色
				rect.call(fill, 'orange');
				circle.call(fill, 'tomato');
			}
			</code>
		</pre>
		<button onclick="d3_selection_call()">试试看</button>
		<script type="text/javascript">
			function d3_selection_call(){
				var circle = d3.select('#d3_selection_call').append('svg').append('circle').attr({
					'cx': '100',
					'cy': '100',
					'r': '40'
				});
				var rect = d3.select('#d3_selection_call').select('svg').append('svg:rect').attr({
					'x': '10',
					'y': '50',
					'width': '40',
					'height': '100'
				});
				//定义色彩填充方法
				function fill(ele, fill){
					this.style('fill', fill);
				}
				//使用call函数调用fill函数填充颜色
				rect.call(fill, 'orange');
				circle.call(fill, 'tomato');
			}
		</script>
	</fieldset>
</div>
</body>
</html>